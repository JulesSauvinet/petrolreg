plotMed = FALSE
col = "green"
#plot(df$mois,exp(predict(m)),type="l",col=col, ylab="gas prod", xlab="mois", main=paste("Rég exp avec k0 =",k0start,"et k1 =",k1start),ylim=c(0,max(exp(predict(m)))+10))
#lines(mois,exp(predict1[,6]),type="l",col="black",lwd = 2,lty=2)
#lines(mois,exp(predict1[,7]),type="l",col="black",lwd = 2,lty=2)
}else if (classif== "bad" && plotBad == TRUE) {
#predict3 = predictNLS(m, df)
plotBad = FALSE
col = "blue"
#plot(df$mois,exp(predict(m)),type="l",col=col, ylab="gas prod", xlab="mois", main=paste("Rég exp avec k0 =",k0start,"et k1 =",k1start),ylim=c(0,max(exp(predict(m)))+10))
#lines(mois,exp(predict1[,6]),type="l",col="black",lwd = 2,lty=2)
#lines(mois,exp(predict1[,7]),type="l",col="black",lwd = 2,lty=2)
}
}
seq1 <- 0:4
#les 75 premiers puits
seq2 <- 1:75
plotGood <- TRUE
plotMed <- TRUE
plotBad <- TRUE
par(mfrow=c(2,3))
for (i in seq2){
mois <- 1:35
v <- as.vector(tdata[,i])
classif = v[36]
v <- as.numeric(v[1:35])
#on plot pas les 0 qui sont des ND (d'apres moi)
nd <- which(v %in% 0)
v <- v[v != 0]
mois <- mois[!mois %in%  nd]
df <- data.frame(mois, v)
df$lv <- log(df$v)
col="black"
k0start=400
k1start=0.01
m <- nls(lv ~ k0*exp(-k1*mois), start=c(k0=k0start, k1=k1start), df)
summary(m)
if (classif == "Good" && plotGood == TRUE){
#predict1 = predictNLS(m, df)
plotGood = FALSE
col = "red"
plot(df$mois,exp(predict(m)),type="l",col=col, ylab="gas prod", xlab="mois", main=paste("Rég exp avec k0 =",k0start,"et k1 =",k1start),ylim=c(0,max(exp(predict(m)))+10))
lines(mois,exp(predict1[,6]),type="l",col="black",lwd = 1,lty=2)
lines(mois,exp(predict1[,7]),type="l",col="black",lwd = 1,lty=2)
}else if (classif == "medium" && plotMed == TRUE){
#predict2 = predictNLS(m, df)
plotMed = FALSE
col = "green"
#plot(df$mois,exp(predict(m)),type="l",col=col, ylab="gas prod", xlab="mois", main=paste("Rég exp avec k0 =",k0start,"et k1 =",k1start),ylim=c(0,max(exp(predict(m)))+10))
#lines(mois,exp(predict1[,6]),type="l",col="black",lwd = 2,lty=2)
#lines(mois,exp(predict1[,7]),type="l",col="black",lwd = 2,lty=2)
}else if (classif== "bad" && plotBad == TRUE) {
#predict3 = predictNLS(m, df)
plotBad = FALSE
col = "blue"
#plot(df$mois,exp(predict(m)),type="l",col=col, ylab="gas prod", xlab="mois", main=paste("Rég exp avec k0 =",k0start,"et k1 =",k1start),ylim=c(0,max(exp(predict(m)))+10))
#lines(mois,exp(predict1[,6]),type="l",col="black",lwd = 2,lty=2)
#lines(mois,exp(predict1[,7]),type="l",col="black",lwd = 2,lty=2)
}
}
seq1 <- 0:4
#les 75 premiers puits
seq2 <- 1:75
plotGood <- TRUE
plotMed <- TRUE
plotBad <- TRUE
par(mfrow=c(2,3))
for (i in seq2){
mois <- 1:35
v <- as.vector(tdata[,i])
classif = v[36]
v <- as.numeric(v[1:35])
#on plot pas les 0 qui sont des ND (d'apres moi)
nd <- which(v %in% 0)
v <- v[v != 0]
mois <- mois[!mois %in%  nd]
df <- data.frame(mois, v)
df$lv <- log(df$v)
col="black"
k0start=400
k1start=0.01
m <- nls(lv ~ k0*exp(-k1*mois), start=c(k0=k0start, k1=k1start), df)
summary(m)
if (classif == "Good" && plotGood == TRUE){
#predict1 = predictNLS(m, df)
plotGood = FALSE
col = "red"
plot(df$mois,exp(predict(m)),type="l",col=col, ylab="gas prod", xlab="mois", main=paste("Rég exp avec k0 =",k0start,"et k1 =",k1start),ylim=c(0,max(exp(predict(m)))+10))
lines(mois,exp(predict1[,6]),type="l",col="black",lwd = 1,lty=2)
lines(mois,exp(predict1[,7]),type="l",col="black",lwd = 1,lty=2)
}else if (classif == "medium" && plotMed == TRUE){
#predict2 = predictNLS(m, df)
plotMed = FALSE
col = "green"
plot(df$mois,exp(predict(m)),type="l",col=col, ylab="gas prod", xlab="mois", main=paste("Rég exp avec k0 =",k0start,"et k1 =",k1start),ylim=c(0,max(exp(predict(m)))+10))
lines(mois,exp(predict1[,6]),type="l",col="black",lwd = 1,lty=2)
lines(mois,exp(predict1[,7]),type="l",col="black",lwd = 1,lty=2)
}else if (classif== "bad" && plotBad == TRUE) {
#predict3 = predictNLS(m, df)
plotBad = FALSE
col = "blue"
#plot(df$mois,exp(predict(m)),type="l",col=col, ylab="gas prod", xlab="mois", main=paste("Rég exp avec k0 =",k0start,"et k1 =",k1start),ylim=c(0,max(exp(predict(m)))+10))
#lines(mois,exp(predict1[,6]),type="l",col="black",lwd = 2,lty=2)
#lines(mois,exp(predict1[,7]),type="l",col="black",lwd = 2,lty=2)
}
}
seq1 <- 0:4
#les 75 premiers puits
seq2 <- 1:75
plotGood <- TRUE
plotMed <- TRUE
plotBad <- TRUE
par(mfrow=c(2,3))
for (i in seq2){
mois <- 1:35
v <- as.vector(tdata[,i])
classif = v[36]
v <- as.numeric(v[1:35])
#on plot pas les 0 qui sont des ND (d'apres moi)
nd <- which(v %in% 0)
v <- v[v != 0]
mois <- mois[!mois %in%  nd]
df <- data.frame(mois, v)
df$lv <- log(df$v)
col="black"
k0start=400
k1start=0.01
m <- nls(lv ~ k0*exp(-k1*mois), start=c(k0=k0start, k1=k1start), df)
summary(m)
if (classif == "Good" && plotGood == TRUE){
#predict1 = predictNLS(m, df)
plotGood = FALSE
col = "red"
plot(df$mois,exp(predict(m)),type="l",col=col, ylab="gas prod", xlab="mois", main=paste("Rég exp avec k0 =",k0start,"et k1 =",k1start),ylim=c(0,max(exp(predict(m)))+10))
lines(mois,exp(predict1[,6]),type="l",col="black",lwd = 1,lty=2)
lines(mois,exp(predict1[,7]),type="l",col="black",lwd = 1,lty=2)
}else if (classif == "medium" && plotMed == TRUE){
predict2 = predictNLS(m, df)
plotMed = FALSE
col = "green"
plot(df$mois,exp(predict(m)),type="l",col=col, ylab="gas prod", xlab="mois", main=paste("Rég exp avec k0 =",k0start,"et k1 =",k1start),ylim=c(0,max(exp(predict(m)))+10))
lines(mois,exp(predict2[,6]),type="l",col="black",lwd = 1,lty=2)
lines(mois,exp(predict2[,7]),type="l",col="black",lwd = 1,lty=2)
}else if (classif== "bad" && plotBad == TRUE) {
#predict3 = predictNLS(m, df)
plotBad = FALSE
col = "blue"
#plot(df$mois,exp(predict(m)),type="l",col=col, ylab="gas prod", xlab="mois", main=paste("Rég exp avec k0 =",k0start,"et k1 =",k1start),ylim=c(0,max(exp(predict(m)))+10))
#lines(mois,exp(predict1[,6]),type="l",col="black",lwd = 2,lty=2)
#lines(mois,exp(predict1[,7]),type="l",col="black",lwd = 2,lty=2)
}
}
seq1 <- 0:4
#les 75 premiers puits
seq2 <- 1:75
plotGood <- TRUE
plotMed <- TRUE
plotBad <- TRUE
par(mfrow=c(2,3))
for (i in seq2){
mois <- 1:35
v <- as.vector(tdata[,i])
classif = v[36]
v <- as.numeric(v[1:35])
#on plot pas les 0 qui sont des ND (d'apres moi)
nd <- which(v %in% 0)
v <- v[v != 0]
mois <- mois[!mois %in%  nd]
df <- data.frame(mois, v)
df$lv <- log(df$v)
col="black"
k0start=400
k1start=0.01
m <- nls(lv ~ k0*exp(-k1*mois), start=c(k0=k0start, k1=k1start), df)
summary(m)
if (classif == "Good" && plotGood == TRUE){
#predict1 = predictNLS(m, df)
plotGood = FALSE
col = "red"
plot(df$mois,exp(predict(m)),type="l",col=col, ylab="gas prod", xlab="mois", main=paste("Rég exp avec k0 =",k0start,"et k1 =",k1start),ylim=c(0,max(exp(predict(m)))+10))
lines(mois,exp(predict1[,6]),type="l",col="black",lwd = 1,lty=2)
lines(mois,exp(predict1[,7]),type="l",col="black",lwd = 1,lty=2)
}else if (classif == "medium" && plotMed == TRUE){
predict2 = predictNLS(m, df)
plotMed = FALSE
col = "green"
plot(df$mois,exp(predict(m)),type="l",col=col, ylab="gas prod", xlab="mois", main=paste("Rég exp avec k0 =",k0start,"et k1 =",k1start),ylim=c(0,max(exp(predict(m)))+10))
lines(mois,exp(predict2[,6]),type="l",col="black",lwd = 1,lty=2)
lines(mois,exp(predict2[,7]),type="l",col="black",lwd = 1,lty=2)
}else if (classif== "bad" && plotBad == TRUE) {
predict3 = predictNLS(m, df)
plotBad = FALSE
col = "blue"
plot(df$mois,exp(predict(m)),type="l",col=col, ylab="gas prod", xlab="mois", main=paste("Rég exp avec k0 =",k0start,"et k1 =",k1start),ylim=c(0,max(exp(predict(m)))+10))
lines(mois,exp(predict1[,6]),type="l",col="black",lwd = 2,lty=2)
lines(mois,exp(predict1[,7]),type="l",col="black",lwd = 2,lty=2)
}
}
seq1 <- 0:4
#les 75 premiers puits
seq2 <- 1:75
plotGood <- TRUE
plotMed <- TRUE
plotBad <- TRUE
par(mfrow=c(2,3))
for (i in seq2){
mois <- 1:35
v <- as.vector(tdata[,i])
classif = v[36]
v <- as.numeric(v[1:35])
#on plot pas les 0 qui sont des ND (d'apres moi)
nd <- which(v %in% 0)
v <- v[v != 0]
mois <- mois[!mois %in%  nd]
df <- data.frame(mois, v)
df$lv <- log(df$v)
col="black"
k0start=400
k1start=0.01
m <- nls(lv ~ k0*exp(-k1*mois), start=c(k0=k0start, k1=k1start), df)
summary(m)
if (classif == "Good" && plotGood == TRUE){
#predict1 = predictNLS(m, df)
plotGood = FALSE
col = "red"
plot(df$mois,exp(predict(m)),type="l",col=col, ylab="gas prod", xlab="mois", main=paste("Rég exp avec k0 =",k0start,"et k1 =",k1start),ylim=c(0,max(exp(predict(m)))+10))
lines(mois,exp(predict1[,6]),type="l",col="black",lwd = 1,lty=2)
lines(mois,exp(predict1[,7]),type="l",col="black",lwd = 1,lty=2)
}else if (classif == "medium" && plotMed == TRUE){
predict2 = predictNLS(m, df)
plotMed = FALSE
col = "green"
plot(df$mois,exp(predict(m)),type="l",col=col, ylab="gas prod", xlab="mois", main=paste("Rég exp avec k0 =",k0start,"et k1 =",k1start),ylim=c(0,max(exp(predict(m)))+10))
lines(mois,exp(predict2[,6]),type="l",col="black",lwd = 1,lty=2)
lines(mois,exp(predict2[,7]),type="l",col="black",lwd = 1,lty=2)
}else if (classif== "bad" && plotBad == TRUE) {
predict3 = predictNLS(m, df)
plotBad = FALSE
col = "blue"
plot(df$mois,exp(predict(m)),type="l",col=col, ylab="gas prod", xlab="mois", main=paste("Rég exp avec k0 =",k0start,"et k1 =",k1start),ylim=c(0,max(exp(predict(m)))+10))
lines(mois,exp(predict3[,6]),type="l",col="black",lwd = 2,lty=2)
lines(mois,exp(predict3[,7]),type="l",col="black",lwd = 2,lty=2)
}
}
seq1 <- 0:4
#les 75 premiers puits
seq2 <- 1:75
plotGood <- TRUE
plotMed <- TRUE
plotBad <- TRUE
par(mfrow=c(2,3))
for (i in seq2){
mois <- 1:35
v <- as.vector(tdata[,i])
classif = v[36]
v <- as.numeric(v[1:35])
#on plot pas les 0 qui sont des ND (d'apres moi)
nd <- which(v %in% 0)
v <- v[v != 0]
mois <- mois[!mois %in%  nd]
df <- data.frame(mois, v)
df$lv <- log(df$v)
col="black"
k0start=400
k1start=0.01
m <- nls(lv ~ k0*exp(-k1*mois), start=c(k0=k0start, k1=k1start), df)
summary(m)
if (classif == "Good" && plotGood == TRUE){
#predict1 = predictNLS(m, df)
plotGood = FALSE
col = "red"
plot(df$mois,exp(predict(m)),type="l",col=col, ylab="gas prod", xlab="mois", main=paste("Rég exp avec k0 =",k0start,"et k1 =",k1start),ylim=c(0,max(exp(predict(m)))+10))
lines(mois,exp(predict1[,6]),type="l",col="black",lwd = 1,lty=2)
lines(mois,exp(predict1[,7]),type="l",col="black",lwd = 1,lty=2)
}else if (classif == "medium" && plotMed == TRUE){
predict2 = predictNLS(m, df)
plotMed = FALSE
col = "green"
plot(df$mois,exp(predict(m)),type="l",col=col, ylab="gas prod", xlab="mois", main=paste("Rég exp avec k0 =",k0start,"et k1 =",k1start),ylim=c(0,max(exp(predict(m)))+10))
lines(mois,exp(predict2[,6]),type="l",col="black",lwd = 1,lty=2)
lines(mois,exp(predict2[,7]),type="l",col="black",lwd = 1,lty=2)
}else if (classif== "bad" && plotBad == TRUE) {
predict3 = predictNLS(m, df)
plotBad = FALSE
col = "blue"
plot(df$mois,exp(predict(m)),type="l",col=col, ylab="gas prod", xlab="mois", main=paste("Rég exp avec k0 =",k0start,"et k1 =",k1start),ylim=c(0,max(exp(predict(m)))+10))
lines(mois,exp(predict3[,6]),type="l",col="black",lwd = 1,lty=2)
lines(mois,exp(predict3[,7]),type="l",col="black",lwd = 1,lty=2)
}
}
plotGood <- TRUE
plotMed <- TRUE
plotBad <- TRUE
par(mfrow=c(2,3))
for (i in seq2){
mois <- 1:35
v <- as.vector(tdata[,i])
classif = v[36]
v <- as.numeric(v[1:35])
#on plot pas les 0 qui sont des ND (d'apres moi)
nd <- which(v %in% 0)
v <- v[v != 0]
mois <- mois[!mois %in%  nd]
df <- data.frame(mois, v)
df$lv <- log(df$v)
col="black"
k0start=400
k1start=0.01
m <- nls(lv ~ k0*exp(-k1*mois), start=c(k0=k0start, k1=k1start), df)
summary(m)
if (classif == "Good" && plotGood == TRUE){
#predict1 = predictNLS(m, df)
plotGood = FALSE
col = "red"
plot(df$mois,exp(predict(m)),type="l",col=col, ylab="gas prod", xlab="mois", main=paste("Régression exponentielle d'une courbe de qualité good avec k0 =",k0start,"et k1 =",k1start),ylim=c(0,max(exp(predict(m)))+10))
lines(mois,exp(predict1[,6]),type="l",col="black",lwd = 1,lty=2)
lines(mois,exp(predict1[,7]),type="l",col="black",lwd = 1,lty=2)
}else if (classif == "medium" && plotMed == TRUE){
predict2 = predictNLS(m, df)
plotMed = FALSE
col = "green"
plot(df$mois,exp(predict(m)),type="l",col=col, ylab="gas prod", xlab="mois", main=paste("Régression exponentielle d'une courbe de qualité medium avec k0 =",k0start,"et k1 =",k1start),ylim=c(0,max(exp(predict(m)))+10))
lines(mois,exp(predict2[,6]),type="l",col="black",lwd = 1,lty=2)
lines(mois,exp(predict2[,7]),type="l",col="black",lwd = 1,lty=2)
}else if (classif== "bad" && plotBad == TRUE) {
predict3 = predictNLS(m, df)
plotBad = FALSE
col = "blue"
plot(df$mois,exp(predict(m)),type="l",col=col, ylab="gas prod", xlab="mois", main=paste("Régression exponentielle d'une courbe de qualité bad avec k0 =",k0start,"et k1 =",k1start),ylim=c(0,max(exp(predict(m)))+10))
lines(mois,exp(predict3[,6]),type="l",col="black",lwd = 1,lty=2)
lines(mois,exp(predict3[,7]),type="l",col="black",lwd = 1,lty=2)
}
}
seq1 <- 0:4
#les 75 premiers puits
seq2 <- 1:75
plotGood <- TRUE
plotMed <- TRUE
plotBad <- TRUE
par(mfrow=c(2,3))
for (i in seq2){
mois <- 1:35
v <- as.vector(tdata[,i])
classif = v[36]
v <- as.numeric(v[1:35])
#on plot pas les 0 qui sont des ND (d'apres moi)
nd <- which(v %in% 0)
v <- v[v != 0]
mois <- mois[!mois %in%  nd]
df <- data.frame(mois, v)
df$lv <- log(df$v)
col="black"
k0start=400
k1start=0.01
m <- nls(lv ~ k0*exp(-k1*mois), start=c(k0=k0start, k1=k1start), df)
summary(m)
if (classif == "Good" && plotGood == TRUE){
#predict1 = predictNLS(m, df)
plotGood = FALSE
col = "red"
plot(df$mois,exp(predict(m)),type="l",col=col, ylab="gas prod", xlab="mois", main=paste("Régression exponentielle d'une courbe \n de qualité good avec k0 =",k0start,"et k1 =",k1start),ylim=c(0,max(exp(predict(m)))+10))
lines(mois,exp(predict1[,6]),type="l",col="black",lwd = 1,lty=2)
lines(mois,exp(predict1[,7]),type="l",col="black",lwd = 1,lty=2)
}else if (classif == "medium" && plotMed == TRUE){
predict2 = predictNLS(m, df)
plotMed = FALSE
col = "green"
plot(df$mois,exp(predict(m)),type="l",col=col, ylab="gas prod", xlab="mois", main=paste("Régression exponentielle d'une courbe \n de qualité medium avec k0 =",k0start,"et k1 =",k1start),ylim=c(0,max(exp(predict(m)))+10))
lines(mois,exp(predict2[,6]),type="l",col="black",lwd = 1,lty=2)
lines(mois,exp(predict2[,7]),type="l",col="black",lwd = 1,lty=2)
}else if (classif== "bad" && plotBad == TRUE) {
predict3 = predictNLS(m, df)
plotBad = FALSE
col = "blue"
plot(df$mois,exp(predict(m)),type="l",col=col, ylab="gas prod", xlab="mois", main=paste("Régression exponentielle d'une courbe \n de qualité bad avec k0 =",k0start,"et k1 =",k1start),ylim=c(0,max(exp(predict(m)))+10))
lines(mois,exp(predict3[,6]),type="l",col="black",lwd = 1,lty=2)
lines(mois,exp(predict3[,7]),type="l",col="black",lwd = 1,lty=2)
}
}
par(mfrow=c(1,1))
for (i in seq2){
mois <- 1:35
v <- as.vector(tdata[,i])
col="black"
if (v[36] == "Good"){
col = "red"
}else if (v[36] == "medium"){
col = "green"
}else
col = "blue"
v <- as.numeric(v[1:35])
#on plot pas les 0 qui sont des ND (d'apres moi)
nd <- which(v %in% 0)
v <- v[v != 0]
mois <- mois[!mois %in%  nd]
smooth <- loess(v~mois)
k0=0.5
k1=0.1
y=k0*exp(-k1*mois)
expfit <- lm(log(smooth$fitted) ~ y)
#tracé de la figure 1 : les données de production
if (i==1){
plot(mois,exp(predict(expfit)),type="l",col=col, ylab="gas prod", main=paste("Régression exponentielle avec smooth et avec k0 =",k0,"et k1 =",k1),ylim=c(0,max(exp(predict(expfit))+10)))
}
lines(mois,predict(expfit),type="l",col=col)
}
par(mfrow=c(1,1))
for (i in seq2){
mois <- 1:35
v <- as.vector(tdata[,i])
col="black"
if (v[36] == "Good"){
col = "red"
}else if (v[36] == "medium"){
col = "green"
}else
col = "blue"
v <- as.numeric(v[1:35])
#on plot pas les 0 qui sont des ND (d'apres moi)
nd <- which(v %in% 0)
v <- v[v != 0]
mois <- mois[!mois %in%  nd]
smooth <- loess(v~mois)
k0=0.5
k1=0.1
y=k0*exp(-k1*mois)
expfit <- lm(log(smooth$fitted) ~ y)
#tracé de la figure 1 : les données de production
if (i==1){
plot(mois,exp(predict(expfit)),type="l",col=col, ylab="gas prod", main=paste("Régression exponentielle avec smooth et avec k0 =",k0,"et k1 =",k1),ylim=c(0,max(exp(predict(expfit))+10)))
}
lines(mois,exp(predict(expfit)),type="l",col=col)
}
par(mfrow=c(1,1))
for (i in seq2){
mois <- 1:35
v <- as.vector(tdata[,i])
col="black"
if (v[36] == "Good"){
col = "red"
}else if (v[36] == "medium"){
col = "green"
}else
col = "blue"
v <- as.numeric(v[1:35])
#on plot pas les 0 qui sont des ND (d'apres moi)
nd <- which(v %in% 0)
v <- v[v != 0]
mois <- mois[!mois %in%  nd]
smooth <- loess(v~mois)
k0=0.5
k1=0.1
y=k0*exp(-k1*mois)
expfit <- lm(log(smooth$fitted) ~ y)
#tracé de la figure 1 : les données de production
if (i==1){
plot(mois,exp(predict(expfit)),type="l",col=col, ylab="gas prod", main=paste("Régression exponentielle avec smooth et avec k0 =",k0,"et k1 =",k1),ylim=c(0,max(predict(expfit))+10))
}
lines(mois,predict(expfit),type="l",col=col)
}
for (i in seq2){
#l'abscisse
mois <- 1:35
#on récupère les données du puits i
v <- as.vector(tdata[,i])
#la couleur en fonction de la classification de qualité
col="black"
if (v[36] == "Good"){
col = "red"
}else if (v[36] == "medium"){
col = "green"
}else
col = "blue"
v <- as.numeric(v[1:35])
#on plot pas les 0 qui sont des ND (d'apres moi)
nd <- which(v %in% 0)
v <- v[v != 0]
mois <- mois[!mois %in%  nd]
smooth <- loess(v~mois)
fit3 <- lm(smooth$fitted ~ poly(mois, 3, raw=TRUE))
if (i==1){
plot(mois, predict(fit3), type="l",col=col, ylab="gas prod", lwd=1, main="Régression polynomiale de degré 3 avec smooth ", ylim=c(0,max(predict(fit3))+10))
}
lines(mois, predict(fit3), col=col, ylab="gas prod", lwd=1)
}
par(mfrow=c(1,1))
for (i in seq2){
mois <- 1:35
v <- as.vector(tdata[,i])
col="black"
if (v[36] == "Good"){
col = "red"
}else if (v[36] == "medium"){
col = "green"
}else
col = "blue"
v <- as.numeric(v[1:35])
#on plot pas les 0 qui sont des ND (d'apres moi)
nd <- which(v %in% 0)
v <- v[v != 0]
mois <- mois[!mois %in%  nd]
smooth <- loess(v~mois)
k0=0.5
k1=0.1
y=k0*exp(-k1*mois)
expfit <- lm(smooth$fitted ~ y)
#tracé de la figure 1 : les données de production
if (i==1){
plot(mois,exp(predict(expfit)),type="l",col=col, ylab="gas prod", main=paste("Régression exponentielle avec smooth et avec k0 =",k0,"et k1 =",k1),ylim=c(0,max(predict(expfit))+10))
}
lines(mois,predict(expfit),type="l",col=col)
}
